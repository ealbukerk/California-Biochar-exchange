<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Biochar.market - Seller</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" />
    <link rel="stylesheet" href="css/style.css" />
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.min.css" />
    <style>
      .seller-nav {
        background: var(--color-surface);
        border-bottom: 1px solid var(--color-border);
      }

      .seller-nav-inner {
        height: 64px;
        display: flex;
        align-items: center;
        justify-content: space-between;
      }

      .seller-nav-logo {
        color: var(--color-accent);
        font-size: var(--font-size-lg);
        font-weight: var(--font-weight-bold);
        text-decoration: none;
      }

      .seller-nav-links {
        display: flex;
        align-items: center;
        gap: var(--space-3);
      }

      .seller-hero {
        background: var(--color-text-primary);
        padding: var(--space-12) 0;
        text-align: center;
      }

      .seller-hero h1 {
        color: white;
        font-size: var(--font-size-3xl);
        font-weight: var(--font-weight-bold);
      }

      .seller-hero p {
        color: rgba(255, 255, 255, 0.85);
        font-size: var(--font-size-lg);
        margin-top: var(--space-4);
      }

      .seller-hero .commission-note {
        color: rgba(255, 255, 255, 0.6);
        font-size: var(--font-size-sm);
        margin-top: var(--space-3);
      }

      .seller-hero .btn {
        margin-top: var(--space-6);
        background: var(--color-accent);
        color: white;
      }

      .listing-status-section {
        padding: var(--space-16) 0;
        background: var(--color-surface);
      }

      .listing-status-section h2,
      .transaction-section h2,
      .map-section h2,
      .commission-section h2,
      .application-section h2,
      .how-it-works-seller h2 {
        font-size: var(--font-size-2xl);
        font-weight: var(--font-weight-bold);
      }

      .status-badge {
        display: inline-flex;
        padding: var(--space-1) var(--space-3);
        border-radius: 999px;
        font-size: var(--font-size-sm);
        font-weight: var(--font-weight-semibold);
      }

      .status-active {
        background: var(--color-accent-light);
        color: var(--color-accent);
      }

      .status-pending {
        background: var(--color-warning-light);
        color: var(--color-warning);
      }

      .status-rejected {
        background: #f5eaea;
        color: #9c3a3a;
      }

      .listing-card {
        margin-top: var(--space-6);
        background: var(--color-surface);
        border: 1px solid var(--color-border);
        border-radius: var(--radius-lg);
        padding: var(--space-6);
        display: grid;
        gap: var(--space-3);
      }

      .listing-meta,
      .muted {
        color: var(--color-text-secondary);
      }

      .feedstock-tag {
        display: inline-flex;
        width: fit-content;
        background: var(--color-accent-light);
        color: var(--color-accent);
        border-radius: var(--radius-sm);
        padding: var(--space-1) var(--space-3);
        font-size: var(--font-size-sm);
        font-weight: var(--font-weight-semibold);
      }

      .edit-grid {
        margin-top: var(--space-4);
        display: grid;
        grid-template-columns: repeat(2, minmax(0, 1fr));
        gap: var(--space-3);
      }

      .edit-grid label {
        font-size: var(--font-size-sm);
        font-weight: var(--font-weight-medium);
      }

      .edit-grid input,
      .edit-grid textarea {
        width: 100%;
        margin-top: var(--space-2);
        border: 1px solid var(--color-border);
        border-radius: var(--radius-md);
        padding: var(--space-3) var(--space-4);
        font-family: var(--font-sans);
      }

      .edit-grid textarea {
        min-height: 90px;
        resize: vertical;
      }

      .full-col {
        grid-column: 1 / -1;
      }

      .transaction-section {
        padding: var(--space-16) 0;
      }

      .summary-row {
        margin-top: var(--space-5);
        display: grid;
        grid-template-columns: repeat(3, minmax(0, 1fr));
        gap: var(--space-4);
      }

      .summary-card {
        background: var(--color-surface);
        border: 1px solid var(--color-border);
        border-radius: var(--radius-md);
        padding: var(--space-4);
      }

      .summary-card p:first-child {
        color: var(--color-text-secondary);
        font-size: var(--font-size-sm);
      }

      .summary-card p:last-child {
        margin-top: var(--space-2);
        font-size: var(--font-size-xl);
        font-weight: var(--font-weight-bold);
        color: var(--color-accent);
      }

      .table-shell {
        margin-top: var(--space-6);
        border: 1px solid var(--color-border);
        border-radius: var(--radius-lg);
        overflow-x: auto;
        background: var(--color-surface);
      }

      table {
        width: 100%;
        border-collapse: collapse;
        min-width: 980px;
      }

      th,
      td {
        text-align: left;
        padding: var(--space-3) var(--space-4);
        border-bottom: 1px solid var(--color-border);
        font-size: var(--font-size-sm);
      }

      th {
        background: var(--color-bg);
      }

      .map-section {
        padding: var(--space-16) 0;
      }

      .map-section p {
        color: var(--color-text-secondary);
        margin-top: var(--space-2);
      }

      #seller-map {
        height: 500px;
        width: 100%;
        margin-top: var(--space-8);
        border-radius: var(--radius-lg);
        overflow: hidden;
      }

      .map-legend {
        background: rgba(26, 26, 26, 0.82);
        color: white;
        border-radius: var(--radius-md);
        padding: var(--space-2) var(--space-3);
        display: grid;
        gap: var(--space-2);
        font-size: var(--font-size-sm);
      }

      .legend-item {
        display: flex;
        align-items: center;
        gap: var(--space-2);
      }

      .legend-dot {
        width: 10px;
        height: 10px;
        border-radius: 50%;
        display: inline-block;
      }

      .application-section {
        padding: var(--space-16) 0;
      }

      .application-section > .container > p {
        text-align: center;
        margin-top: var(--space-2);
        color: var(--color-text-secondary);
      }

      .apply-form {
        max-width: 560px;
        margin: var(--space-8) auto 0;
        background: var(--color-surface);
        border-radius: var(--radius-lg);
        padding: var(--space-8);
        border: 1px solid var(--color-border);
      }

      .form-group {
        margin-bottom: var(--space-5);
      }

      .form-group label {
        font-size: var(--font-size-sm);
        font-weight: var(--font-weight-medium);
      }

      .form-group input,
      .form-group select,
      .form-group textarea {
        width: 100%;
        border: 1px solid var(--color-border);
        border-radius: var(--radius-md);
        padding: var(--space-3) var(--space-4);
        margin-top: var(--space-2);
        font-family: var(--font-sans);
      }

      .field-note {
        margin-top: var(--space-2);
        color: var(--color-text-muted);
        font-size: var(--font-size-sm);
      }

      #file-list {
        margin-top: var(--space-3);
        display: flex;
        flex-wrap: wrap;
        gap: var(--space-2);
      }

      .file-tag {
        display: inline-flex;
        align-items: center;
        gap: var(--space-2);
        padding: var(--space-1) var(--space-3);
        border-radius: 999px;
        background: var(--color-accent-light);
        color: var(--color-accent);
        font-size: var(--font-size-sm);
      }

      .file-tag button {
        border: none;
        background: transparent;
        color: inherit;
        cursor: pointer;
      }

      .site-footer {
        border-top: 1px solid var(--color-border);
        padding: var(--space-8) 0;
      }

      .footer-inner {
        display: flex;
        justify-content: space-between;
        align-items: center;
        font-size: var(--font-size-sm);
        color: var(--color-text-muted);
      }

      .hidden {
        display: none !important;
      }

      @media (max-width: 1000px) {
        .edit-grid,
        .summary-row {
          grid-template-columns: 1fr;
        }
      }
    </style>
  </head>
  <body>
    <nav class="seller-nav">
      <div class="container seller-nav-inner">
        <a class="seller-nav-logo" href="index.html">BM</a>
        <div class="seller-nav-links">
          <a id="nav-login" class="btn btn-secondary" href="auth.html">Login</a>
          <a id="nav-profile" class="btn btn-secondary hidden" href="profile.html">Profile</a>
          <button id="nav-logout" class="btn btn-primary hidden" type="button">Log out</button>
        </div>
      </div>
    </nav>

    <section class="seller-hero">
      <div class="container-narrow">
        <h1>List your biochar. Reach buyers across the US.</h1>
        <p>Free to list. 4% commission only on completed transactions. No subscription.</p>
        <p class="commission-note">We take a small commission on each sale, dependent on order size — typically around 3.5%.</p>
        <div id="hero-auth-slot"></div>
      </div>
    </section>

    <section id="listing-status-section" class="listing-status-section hidden">
      <div class="container">
        <h2>Your listing</h2>
        <div id="listing-status-content" style="margin-top: var(--space-5);"></div>
      </div>
    </section>

    <section id="transaction-section" class="transaction-section hidden">
      <div class="container">
        <h2>Your transactions</h2>
        <div id="transaction-content" style="margin-top: var(--space-5);"></div>
      </div>
    </section>

    <section class="map-section">
      <div class="container">
        <h2>Producers and buyers across the platform</h2>
        <p>Green markers are producers. Red markers are buyers.</p>
        <div id="seller-map"></div>
      </div>
    </section>

    <section id="application-section" class="application-section">
      <div class="container">
        <h2 style="text-align: center;">Apply to list your biochar</h2>
        <p>Applications reviewed within 2 business days.</p>

        <form id="producer-form" class="apply-form">
          <div class="form-group">
            <label for="business-name">Business name</label>
            <input id="business-name" name="businessName" type="text" required />
          </div>

          <div class="form-group">
            <label for="contact-name">Contact name</label>
            <input id="contact-name" name="contactName" type="text" required />
          </div>

          <div class="form-group">
            <label for="email">Email address</label>
            <input id="email" name="email" type="email" required />
          </div>

          <div class="form-group">
            <label for="county-operation">County of operation</label>
            <input id="county-operation" name="county" type="text" required />
          </div>

          <div class="form-group">
            <label for="feedstock">Primary feedstock</label>
            <div id="ms-feedstock-producer"></div>
            <input id="feedstock" type="hidden" name="feedstock" />
          </div>

          <div class="form-group">
            <label for="tonnes">Approximate available tonnes</label>
            <input id="tonnes" name="availableTonnes" type="number" min="0" />
          </div>

          <div class="form-group">
            <label for="lab-report">Lab Report Status</label>
            <select id="lab-report" name="labReport">
              <option value="">Select one</option>
              <option value="Yes">Yes</option>
              <option value="No">No</option>
              <option value="In progress">In progress</option>
            </select>
          </div>

          <div class="form-group">
            <label>Certifications held</label>
            <div id="ms-certs-producer"></div>
            <input id="producer-certs" type="hidden" name="certifications" />
          </div>

          <div class="form-group">
            <label for="cert-docs">Upload certification documents</label>
            <p class="field-note">Upload your OMRI, IBI, or CDFA certificate PDFs. Accepted formats: PDF, JPG, PNG. Max 5MB per file.</p>
            <input id="cert-docs" name="certDocs" type="file" multiple accept=".pdf,.jpg,.jpeg,.png" />
            <div id="file-list"></div>
          </div>

          <div class="form-group">
            <label for="operation-details">Tell us about your operation</label>
            <textarea id="operation-details" name="notes" rows="3"></textarea>
          </div>

          <div>
            <button type="submit" class="btn btn-primary">Submit application</button>
          </div>
        </form>
        <div id="form-success" style="display: none; max-width: 560px; margin: var(--space-6) auto 0;">
          <p>Thank you — we'll review your application within 2 business days.</p>
        </div>
        <div id="form-error" style="display: none; max-width: 560px; margin: var(--space-4) auto 0; color: var(--color-warning);"></div>
      </div>
    </section>

    <footer class="site-footer">
      <div class="container footer-inner">
        <span>© 2025 Biochar.market</span>
        <span>United States · 2025</span>
      </div>
    </footer>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.min.js"></script>
    <script src="js/firebase-config.js"></script>
    <script src="js/auth-state.js"></script>
    <script src="js/multiselect.js"></script>
    <script src="js/airtable.js"></script>
    <script src="js/commission.js"></script>
    <script src="js/seller.js"></script>
  </body>
</html>
